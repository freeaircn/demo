(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-bbf9"],{"/zmP":function(e,o,t){"use strict";var r=t("WvzK");t.n(r).a},"A+kU":function(e,o,t){},PhZV:function(e,o,t){"use strict";var r=t("A+kU");t.n(r).a},WvzK:function(e,o,t){},bPQK:function(e,o,t){"use strict";t.d(o,"a",function(){return r});var r={REGEX_POHONE:/^[1][0-9]$/,REGEX_MAIL:/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,REGEX_PASSWORD:/^[0-9a-zA-Z]+$/,REGEX_ZH_CHAR:/^([\u4e00-\u9fa5]){2,5}$/,MAIL_163_URL:"https://mail.163.com",MAIL_126_URL:"https://mail.126.com",MAIL_QQ_URL:"https://mail.qq.com"}},h97h:function(e,o,t){"use strict";t.r(o);var r=t("XJYT"),a=t("t3Un");var s=t("42cJ"),n=t("bPQK"),i={name:"Signup",data:function(){var e=this,o=n.a.REGEX_POHONE,t=n.a.REGEX_MAIL,r=n.a.REGEX_PASSWORD,a=n.a.REGEX_ZH_CHAR;return{activeStep:0,formBaseInfo:{userphone:"",email:"",password:"",confirmPassword:""},formBaseInfoRules:{userphone:[{required:!0,trigger:"change",validator:function(e,t,r){""===t?r(new Error("请输入手机号！")):o.test(t)?r():r(new Error("请输入11位有效的手机号！"))}}],email:[{required:!0,trigger:"change",validator:function(e,o,r){""===o?r(new Error("请输入电子邮箱！")):t.test(o)?r():r(new Error("邮箱地址有误！"))}}],password:[{required:!0,trigger:"change",validator:function(o,t,a){""===t?a(new Error("请输入密码")):r.test(t)?(""!==e.formBaseInfo.confirmPassword&&e.$refs.formBaseInfo.validateField("confirmPassword"),a()):a(new Error("密码最小长度为8位，必须包含大写、小写字母、数字！"))}}],confirmPassword:[{required:!0,trigger:"change",validator:function(o,t,r){""===t?r(new Error("请再次输入密码")):t!==e.formBaseInfo.password?r(new Error("两次输入密码不一致!")):r()}}]},userid:"",formMoreInfo:{username:"",gender:"",parties:"",company:"",deptLevel1:"",deptLevel2:"",job:""},formMoreInfoRules:{username:[{required:!0,trigger:"change",validator:function(e,o,t){""===o?t(new Error("请输入中文姓名！")):a.test(o)?t():t(new Error("有效姓名：2~5个中文！"))}}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],parties:[{required:!0,message:"请选择党派",trigger:"change"}],company:[{required:!0,message:"请选择公司",trigger:"change"}],deptLevel1:[{required:!0,message:"请选择电厂",trigger:"change"}],deptLevel2:[{required:!0,message:"请选择班组",trigger:"change"}],job:[{required:!0,message:"请选择职务",trigger:"change"}]},loading:!1,pwdType:"password",redirect:void 0}},computed:{emailLowcase:function(){return this.formBaseInfo.email.toLowerCase()}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},methods:{showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},checkInfo:function(e){var o=this.formBaseInfo.userphone,t=n.a.REGEX_POHONE,i=this.emailLowcase,l=n.a.REGEX_MAIL;switch(e){case"phone":t.test(o)&&function(e){return Object(a.a)({url:"/users/check_phone",method:"post",data:{phone:e}})}(o).then(function(e){e.code===s.a.USERS_SIGNUP_IDENTITY_EXISTING&&(this.$refs.userphone.resetField(),Object(r.Message)({message:o+e.msg,showClose:!0,type:"error",duration:3e3}))}.bind(this)).catch(function(e){console.log(e)});break;case"email":l.test(i)&&function(e){return Object(a.a)({url:"/users/check_email",method:"post",data:{email:e}})}(i).then(function(e){e.code===s.a.USERS_SIGNUP_EMAIL_EXISTING&&(this.$refs.email.resetField(),Object(r.Message)({message:i+e.msg,showClose:!0,type:"error",duration:3e3}))}.bind(this)).catch(function(e){console.log(e)})}},handleCreateUser:function(){var e=this;this.$refs.formBaseInfo.validate(function(o){if(!o)return console.log("error submit!!"),!1;var t=e.formBaseInfo.userphone,n=e.emailLowcase,i=e.formBaseInfo.password;e.$confirm("请核对信息"+t+"，"+n+" 是否正确?","提示",{confirmButtonText:"正确",cancelButtonText:"返回",type:"warning"}).then(function(){(function(e,o,t){return Object(a.a)({url:"/users/create_user",method:"post",data:{phone:e,email:o,password:t}})})(t,n,i).then(function(e){e.code===s.a.SUCCESS?(this.userid=e.userid,this.activeStep+=1):e.code===s.a.USERS_SIGNUP_USER_CREATE_FAILED&&Object(r.Message)({message:e.msg,showClose:!0,type:"error",duration:3e3})}.bind(e)).catch(function(e){console.log(e)})}).catch(function(){e.$message({type:"info",message:"已取消注册"})})})},handleResetBaseInfo:function(){this.$refs.formBaseInfo.resetFields()},handleMoreInfo:function(){var e=this;this.$refs.formMoreInfo.validate(function(o){if(!o)return console.log("error submit!!"),!1;(function(e,o,t,r,s,n,i,l){return Object(a.a)({url:"/users/log_user_info",method:"post",data:{userid:e,username:o,gender:t,parties:r,company:s,dept_level_1:n,dept_level_2:i,job:l}})})(e.userid,e.formMoreInfo.username,e.formMoreInfo.gender,e.formMoreInfo.parties,e.formMoreInfo.company,e.formMoreInfo.deptLevel1,e.formMoreInfo.deptLevel2,e.formMoreInfo.job).then(function(e){e.code===s.a.SUCCESS?this.activeStep+=1:e.code===s.a.USERS_SIGNUP_LOG_USER_INFO_FAILED&&Object(r.Message)({message:e.msg,showClose:!0,type:"error",duration:3e3})}.bind(e)).catch(function(e){console.log(e)})})},handleResetMoreInfo:function(){this.$refs.formMoreInfo.resetFields()},handleToLogin:function(){this.$router.push({name:"login"})}}},l=(t("/zmP"),t("PhZV"),t("KHd+")),c=Object(l.a)(i,function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"signup-wrapper"},[t("div",{staticClass:"signup-container"},[e._m(0),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.activeStep,expression:"activeStep === 0"}],staticClass:"form-baseinfo-container"},[t("el-form",{ref:"formBaseInfo",staticClass:"signup-form container-sm px-responsive",attrs:{model:e.formBaseInfo,rules:e.formBaseInfoRules,"label-position":"left"}},[t("el-form-item",{ref:"userphone",attrs:{prop:"userphone"}},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"icon_mobilephone"}})],1),e._v(" "),t("el-input",{attrs:{name:"userphone",type:"text",placeholder:"手机号",clearable:""},on:{blur:function(o){e.checkInfo("phone")}},model:{value:e.formBaseInfo.userphone,callback:function(o){e.$set(e.formBaseInfo,"userphone",o)},expression:"formBaseInfo.userphone"}})],1),e._v(" "),t("el-form-item",{ref:"email",attrs:{prop:"email"}},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"icon_dmail_fill"}})],1),e._v(" "),t("el-input",{attrs:{name:"email",type:"text",placeholder:"电子邮箱",clearable:""},on:{blur:function(o){e.checkInfo("email")}},model:{value:e.formBaseInfo.email,callback:function(o){e.$set(e.formBaseInfo,"email",o)},expression:"formBaseInfo.email"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"password"}},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),t("el-input",{attrs:{type:e.pwdType,name:"password",placeholder:"密码",clearable:""},model:{value:e.formBaseInfo.password,callback:function(o){e.$set(e.formBaseInfo,"password",o)},expression:"formBaseInfo.password"}}),e._v(" "),t("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[t("svg-icon",{attrs:{"icon-class":"password"===e.pwdType?"eye":"eye-open"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"confirmPassword"}},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),t("el-input",{attrs:{type:e.pwdType,name:"confirmPassword",placeholder:"确认密码",clearable:""},model:{value:e.formBaseInfo.confirmPassword,callback:function(o){e.$set(e.formBaseInfo,"confirmPassword",o)},expression:"formBaseInfo.confirmPassword"}}),e._v(" "),t("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[t("svg-icon",{attrs:{"icon-class":"password"===e.pwdType?"eye":"eye-open"}})],1)],1),e._v(" "),t("div",{staticStyle:{margin:"0px 0px 15px 0px",color:"#409EFF"}},[t("router-link",{attrs:{to:"/login"}},[e._v("已有账号？去登录")])],1),e._v(" "),t("el-row",{attrs:{type:"flex",justify:"space-between"}},[t("el-col",{attrs:{span:10}},[t("div",{staticClass:"grid-content"},[t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(o){return o.preventDefault(),e.handleCreateUser(o)}}},[e._v("注 册")])],1)]),e._v(" "),t("el-col",{attrs:{span:10}},[t("div",{staticClass:"grid-content"},[t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading},nativeOn:{click:function(o){return o.preventDefault(),e.handleResetBaseInfo(o)}}},[e._v("清 空")])],1)])],1),e._v(" "),t("div",{staticClass:"tips"},[t("p",[e._v("1. 请用户输入手机号和电子邮箱")]),e._v(" "),t("p",[e._v("2. 注册后，系统将发送账户激活邮件至用户登记的电子邮箱")]),e._v(" "),t("p",[e._v("3. 激活后，用户将使用手机号登录")]),e._v(" "),t("p",[e._v("4. 请勿用银行密码和支付软件密码作为该账号密码")])])],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.activeStep,expression:"activeStep === 1"}],staticClass:"form-moreinfo-container"},[t("el-form",{ref:"formMoreInfo",staticClass:"signup-form container-sm px-responsive",attrs:{model:e.formMoreInfo,rules:e.formMoreInfoRules,"label-position":"right"}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{name:"username",type:"text",placeholder:"中文姓名",clearable:""},model:{value:e.formMoreInfo.username,callback:function(o){e.$set(e.formMoreInfo,"username",o)},expression:"formMoreInfo.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"性别",prop:"gender"}},[t("el-radio-group",{model:{value:e.formMoreInfo.gender,callback:function(o){e.$set(e.formMoreInfo,"gender",o)},expression:"formMoreInfo.gender"}},[t("el-radio",{attrs:{label:"男"}},[e._v("男")]),e._v(" "),t("el-radio",{attrs:{label:"女"}},[e._v("女")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"党派",prop:"parties"}},[t("el-radio-group",{model:{value:e.formMoreInfo.parties,callback:function(o){e.$set(e.formMoreInfo,"parties",o)},expression:"formMoreInfo.parties"}},[t("el-radio",{attrs:{label:"1"}},[e._v("无党派")]),e._v(" "),t("el-radio",{attrs:{label:"2"}},[e._v("中共党员")]),e._v(" "),t("el-radio",{attrs:{label:"3"}},[e._v("其他党派")])],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"company"}},[t("el-select",{attrs:{placeholder:"请选择所属公司"},model:{value:e.formMoreInfo.company,callback:function(o){e.$set(e.formMoreInfo,"company",o)},expression:"formMoreInfo.company"}},[t("el-option",{attrs:{label:"保山能源发展股份有限公司",value:"1"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"deptLevel1"}},[t("el-select",{attrs:{placeholder:"请选择所属电厂"},model:{value:e.formMoreInfo.deptLevel1,callback:function(o){e.$set(e.formMoreInfo,"deptLevel1",o)},expression:"formMoreInfo.deptLevel1"}},[t("el-option",{attrs:{label:"松山河口电厂",value:"1"}}),e._v(" "),t("el-option",{attrs:{label:"苏家河口电厂",value:"2"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"deptLevel2"}},[t("el-select",{attrs:{placeholder:"请选择所属班组"},model:{value:e.formMoreInfo.deptLevel2,callback:function(o){e.$set(e.formMoreInfo,"deptLevel2",o)},expression:"formMoreInfo.deptLevel2"}},[t("el-option",{attrs:{label:"检修班",value:"1"}}),e._v(" "),t("el-option",{attrs:{label:"运行一班",value:"2"}}),e._v(" "),t("el-option",{attrs:{label:"运行二班",value:"3"}}),e._v(" "),t("el-option",{attrs:{label:"运行三班",value:"4"}}),e._v(" "),t("el-option",{attrs:{label:"运行四班",value:"5"}}),e._v(" "),t("el-option",{attrs:{label:"运行五班",value:"6"}}),e._v(" "),t("el-option",{attrs:{label:"办公室",value:"7"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"job"}},[t("el-select",{attrs:{placeholder:"请选择职务"},model:{value:e.formMoreInfo.job,callback:function(o){e.$set(e.formMoreInfo,"job",o)},expression:"formMoreInfo.job"}},[t("el-option",{attrs:{label:"检修员",value:"1"}}),e._v(" "),t("el-option",{attrs:{label:"运行员",value:"2"}}),e._v(" "),t("el-option",{attrs:{label:"班长",value:"3"}})],1)],1),e._v(" "),t("el-row",{attrs:{type:"flex",justify:"space-between"}},[t("el-col",{attrs:{span:10}},[t("div",{staticClass:"grid-content"},[t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(o){return o.preventDefault(),e.handleMoreInfo(o)}}},[e._v("提 交")])],1)]),e._v(" "),t("el-col",{attrs:{span:10}},[t("div",{staticClass:"grid-content"},[t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading},nativeOn:{click:function(o){return o.preventDefault(),e.handleResetMoreInfo(o)}}},[e._v("清 空")])],1)])],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeStep,expression:"activeStep === 2"}]},[t("h3",{staticStyle:{color:"#2d8cf0","text-align":"center",margin:"20px"}},[e._v("完成注册")]),e._v(" "),t("div",{staticClass:"signup-form"},[t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(o){return o.preventDefault(),e.handleToLogin(o)}}},[e._v("去登录")])],1)])])])},[function(){var e=this.$createElement,o=this._self._c||e;return o("div",{staticClass:"signup-header py-responsive is-center"},[o("h1",{staticClass:"title"},[this._v("欢迎加入我们")])])}],!1,null,"958e04ce",null);c.options.__file="index.vue";o.default=c.exports}}]);